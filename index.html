<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>London map</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <link href="external.css" rel="stylesheet">
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.45.0/mapbox-gl.js'></script>
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.45.0/mapbox-gl.css' rel='stylesheet' />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css"> 
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> 
    <style>
        body { margin:0; padding:0; }
        #map { position:relative; top:0; bottom:0;width:100%; height:400px; }
        #map2 { position:relative; top:0; bottom:0;width:100%; height:300px; }
        #dock {position:absolute; top:80%;}
    </style>
</head>
<body>
    
    
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
      <a class="navbar-brand" href="#">London Data</a> </div>
    <div class="navbar-collapse collapse">
      <form class="navbar-form navbar-right" role="form">
        
      </form>
    </div>
    <!--/.navbar-collapse --> 
  </div>
</div>


    <div class="image">
<img src="1.jpeg" alt="" />
<div class="text-block"> 


<h2><span>London for tourists:<br/>Find better place</span></h2><br/>
        <h4><span>Plan trip to London but don't know where to stay?<br/>
This web pages will help you to find better place.<br/> This map will show you amount of proposals <br/> in particular ward and average price. You also<br/> can compare ward wealth by level of property <br/> located there and average income of inhabitants.</span></h4>
          </div>
    </div>
<div class = "container">
   <div class = "row">
       <div class = "col-xs-4" align="center">
           <h3><a href='https://tfl.gov.uk/tfl/syndication/widgets/tubemap/default-search.html'>London Tube</a>
           </h3>
       </div>
      <div class = "col-xs-4" align="center">
          <h3><a href='https://www.airbnb.ru/s/London--United-Kingdom/homes?adults=1&children=0&infants=0&query=London%2C%20United%20Kingdom&place_id=ChIJdd4hrwug2EcRmSrV3Vo6llI&refinement_paths%5B%5D=%2Fhomes&allow_override%5B%5D=&s_tag=JD52Wogo'>AirBnB</a></h3>
       </div>
      <div class = "col-xs-4" align="center">
          <h3><a href='https://www.visitlondon.com/'>Visit London</a></h3>
       </div>
   </div>
</div>
        

    
    
<div class="container"><div id="list">
    <select onchange="chooseFunction(this.value)">
        <option selected disabled>Choose layer</option>
        <option value="1">AirBNB
        <option value="2">Houseprice   
    </select>
</div><div id='map'></div></div> 
    
<div class="container">
  
    
    
    <img src="2.jpg" width="100%">
    
    
<div class="container">
    <div class = "row">
      <div class = "col-xs-6">
        
         <h1>AIRBNB DATA</h1>
    <h3><span>Median price: 128 pounds<br/>
    Available proposals: 64144<br/>
    Frequent price: 68 pounds<br/>
        </span></h3>
        
        </div>
        <div class = "col-xs-6"><div id="map2"></div></div>
    
    
         </div>    
    </div>
    
  
<script>
mapboxgl.accessToken = 'pk.eyJ1IjoibWlraGFpbHNva29sb3YiLCJhIjoiY2pldjZ0NHZqMGI5MTJxbDd1dHV3ZDl0eiJ9.omvRoGjfSasjuCVj9TRJRw';

var bounds = [
    [-0.475,51.236], // Southwest coordinates
    [0.465,51.965]];
var map = new mapboxgl.Map({
    container: 'map', // container id
    style: 'mapbox://styles/mikhailsokolov/cjh7vcg6v03yu2rmzpe5mzq9s', // stylesheet location
    center: [-0.049,51.518], // starting position [lng, lat]
    zoom: 12, // starting zoom
    maxBounds: bounds
});
    
    
var map2 = new mapboxgl.Map({
    container: 'map2', // container id
    style: 'mapbox://styles/mikhailsokolov/cjj4ppnhl0ega2smliqkwz37k', // stylesheet location
    center: [-0.049,51.518], // starting position [lng, lat]
    zoom: 10
, // starting zoom
    Pitch: 40,
    maxBounds: bounds
});    
    
    
 function chooseFunction(value){
     if (value === '1'){
         airFunction();
     } else if (value === '2'){
         airFunction2();
     } else if (value === '3'){
         airFunction3();
     }
     console.log(value)
     
 }   
    
    
var xmlhttp = new XMLHttpRequest();
var url = "bnb2.geojson";
function airFunction(){
    console.log("hello");
    
    map.setLayoutProperty("houseprice", 'visibility', 'none');
    map.setLayoutProperty("bnb", 'visibility', 'visible');
    };
function airFunction2(){
    
  map.setLayoutProperty("bnb", 'visibility', 'none');
    map.setLayoutProperty("houseprice", 'visibility', 'visible');
     map.setPitch(0);
};  
function ProcessData(data) {

 
  map.addSource("bnb", { type: "geojson", data: data});
  map.addLayer({
    "id": "houseprice",
    "source": "bnb",
    "type": "fill",
    "layout": {visibility:"none"},
    "paint": {
        'fill-color': {
            'property':"housepricenum",
            'type':"exponential",
            "stops":[
                [0, "white"],
                [1000000, "green"],
                [2000000, "magenta"]
                           ]
        },
        'fill-opacity': 0.4

  }
    });
    

    
    map.addLayer({
    "id": "bnb",
    "source": "bnb",
    "type": "fill",
    'layout': {visibility:"none"},
        
    "paint": {
            'fill-color': {'property':"percent",
                           'type':"exponential",
                           "stops":[
                               [0, "white"],
                                [15, "red"]
                           ]
        },
        'fill-opacity': 0.4

  }});
    
    
    
}
    
    


  map.on('click', 'bnb', function(e) {

    //BikeParkingSlotsAmount
    var coordinates = e.features[0].geometry.coordinates.slice();
    var description = e.features[0].properties;
    console.log(coordinates);
    console.log(description);

    new mapboxgl.Popup()
      .setLngLat(e.lngLat)
      .setHTML('<h4>'+description.NAME+'</h4><p>Amount of Households: </p>'+ description.houses + '<p>Percentage of Airbnb users: </p>' + description.percent)
      .addTo(map);


  });
    
map.on('click', 'houseprice', function(e){
    var description = e.features[0].properties;
    var coordinates = e.features[0].geometry.coordinates.slice();
    console.log(e.features[0])
    new mapboxgl.Popup()
    .setLngLat(e.lngLat)
    .setHTML('<h4>'+description.NAME+'</h4><p>Median salary: </p>'+ description.income + '<p>Average price of the house: </p>' + description.houseprice)
      .addTo(map);
}
      );    



    
    


xmlhttp.onreadystatechange = function() {
if (this.readyState == 4 && this.status == 200) {
    var json = JSON.parse(this.responseText);
      ProcessData(json);
    }
};


//event map fully loaded
map.on("load", function() {
  xmlhttp.open("GET", url, true);
  xmlhttp.send();
});



</script>

</body>
</html>
